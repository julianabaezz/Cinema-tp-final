{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\User\\\\Desktop\\\\Programaci\\xF3n\\\\Clases Ada\\\\proyectos\\\\TP FINAL\\\\cinemada\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\User\\\\Desktop\\\\Programaci\\xF3n\\\\Clases Ada\\\\proyectos\\\\TP FINAL\\\\cinemada\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\User\\\\Desktop\\\\Programaci\\xF3n\\\\Clases Ada\\\\proyectos\\\\TP FINAL\\\\cinemada\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useEffect,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{itemsApi}from\"../../api/moviesDB\";import{api_DB}from\"../../utils\";import{usersApi}from\"../../api/users\";var useItems=function useItems(){var params=new URLSearchParams(window.location.search);var page=Number(params.get(\"page\"))||1;var search=params.get(\"search\")||undefined;var _useHistory=useHistory(),push=_useHistory.push;var _useState=useState(),_useState2=_slicedToArray(_useState,2),items=_useState2[0],setItems=_useState2[1];//SEARCH MULTI\nuseEffect(function(){itemsApi.searchMulti({page:page,search:search}).then(function(response){return setItems(response);});},[page,search]);//PAGE PARAMS\nvar setPageParams=function setPageParams(page){params.set(\"page\",page.toString());push(\"\".concat(window.location.pathname,\"?\").concat(params.toString()));};//SEARCH PARAMS\nvar setSearchParams=function setSearchParams(input){params.set(\"search\",input);push(\"\".concat(window.location.pathname,\"?\").concat(params.toString()));};//USE ITEMS FB\nvar getItems=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return itemsApi.getItemsFB();case 2:response=_context.sent;return _context.abrupt(\"return\",response);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getItems(){return _ref.apply(this,arguments);};}();var addItem=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(datos){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return itemsApi.addItemFB(datos);case 2:getItems();case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function addItem(_x){return _ref2.apply(this,arguments);};}();var deleteItem=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return itemsApi.deleteItemFB(id);case 2:getItems();case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteItem(_x2){return _ref3.apply(this,arguments);};}();var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),itemDetail=_useState4[0],setDetail=_useState4[1];var getDetail=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return itemsApi.getItemFB(id).then(function(response){setDetail(response);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function getDetail(_x3){return _ref4.apply(this,arguments);};}();var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),itemsFB=_useState6[0],setItemsFB=_useState6[1];var displayItemsFB=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return getItems().then(function(response){setItemsFB(response);});case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function displayItemsFB(){return _ref5.apply(this,arguments);};}();//ITEM VIEWED\nvar getUsers=usersApi.getUsers;var addItemViewed=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(currentUser,item){var itemsViewed;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:itemsViewed=(currentUser===null||currentUser===void 0?void 0:currentUser.viewed)||[];itemsViewed.push(item);_context6.next=4;return api_DB.patch(\"/users/\".concat(currentUser===null||currentUser===void 0?void 0:currentUser.idDB,\".json\"),{viewed:itemsViewed});case 4:getUsers();case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function addItemViewed(_x4,_x5){return _ref6.apply(this,arguments);};}();var deleteItemViewed=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(currentUser,item){var _currentUser$viewed;var itemsViewed;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:itemsViewed=currentUser===null||currentUser===void 0?void 0:(_currentUser$viewed=currentUser.viewed)===null||_currentUser$viewed===void 0?void 0:_currentUser$viewed.filter(function(i){return i!==item;});_context7.next=3;return api_DB.patch(\"/users/\".concat(currentUser===null||currentUser===void 0?void 0:currentUser.idDB,\".json\"),{viewed:itemsViewed});case 3:getUsers();case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function deleteItemViewed(_x6,_x7){return _ref7.apply(this,arguments);};}();var itemsViewed=function itemsViewed(currentUser,id){var _currentUser$viewed2;var itemViewed=currentUser===null||currentUser===void 0?void 0:(_currentUser$viewed2=currentUser.viewed)===null||_currentUser$viewed2===void 0?void 0:_currentUser$viewed2.includes(id);return itemViewed;};return{addItem:addItem,deleteItem:deleteItem,getItems:getItems,getDetail:getDetail,setDetail:setDetail,displayItemsFB:displayItemsFB,setPageParams:setPageParams,setSearchParams:setSearchParams,addItemViewed:addItemViewed,deleteItemViewed:deleteItemViewed,itemsViewed:itemsViewed,items:items,itemDetail:itemDetail,itemsFB:itemsFB,page:page};};export{useItems};","map":{"version":3,"sources":["C:/Users/User/Desktop/ProgramaciÃ³n/Clases Ada/proyectos/TP FINAL/cinemada/src/hooks/useItems/index.ts"],"names":["useEffect","useState","useHistory","itemsApi","api_DB","usersApi","useItems","params","URLSearchParams","window","location","search","page","Number","get","undefined","push","items","setItems","searchMulti","then","response","setPageParams","set","toString","pathname","setSearchParams","input","getItems","getItemsFB","addItem","datos","addItemFB","deleteItem","id","deleteItemFB","itemDetail","setDetail","getDetail","getItemFB","itemsFB","setItemsFB","displayItemsFB","getUsers","addItemViewed","currentUser","item","itemsViewed","viewed","patch","idDB","deleteItemViewed","filter","i","itemViewed","includes"],"mappings":"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","sourcesContent":["import { useEffect, useState} from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { itemsApi} from \"../../api/moviesDB\";\r\nimport { ApiResponse, Items, User } from \"../../types/models\";\r\nimport { api_DB } from \"../../utils\";\r\nimport {usersApi } from \"../../api/users\";\r\n\r\nconst useItems = () =>{\r\n    const params = new URLSearchParams(window.location.search)\r\n    const page = Number(params.get(\"page\")) || 1\r\n    const search = params.get(\"search\") || undefined\r\n    const {push} = useHistory()\r\n    const [items, setItems] = useState<ApiResponse>()\r\n\r\n    //SEARCH MULTI\r\n    useEffect(() => {\r\n        itemsApi\r\n        .searchMulti({page, search})\r\n        .then((response) => setItems(response))\r\n    }, [page, search])\r\n\r\n    //PAGE PARAMS\r\n    const setPageParams = (page: number) =>{\r\n        params.set(\"page\", page.toString())\r\n        push(`${window.location.pathname}?${params.toString()}`)        \r\n\r\n    }\r\n    //SEARCH PARAMS\r\n    const setSearchParams= (input: string) =>{\r\n        params.set(\"search\", input)\r\n        push(`${window.location.pathname}?${params.toString()}`)\r\n    }\r\n    //USE ITEMS FB\r\n    const getItems = async()=>{\r\n        const response = await itemsApi.getItemsFB();\r\n        return response\r\n        \r\n    }\r\n\r\n    const addItem= async(datos: Items) =>{        \r\n        await itemsApi.addItemFB(datos);\r\n        getItems()\r\n        \r\n    };\r\n\r\n    const deleteItem = async(id:number) =>{\r\n        await itemsApi.deleteItemFB(id)\r\n        getItems()\r\n    }\r\n    const [itemDetail, setDetail] = useState<Items>()\r\n\r\n    const getDetail= async(id:string) =>{\r\n        await itemsApi.getItemFB(id).then((response) => { setDetail(response)})\r\n    }\r\n    const [itemsFB, setItemsFB] = useState<Items[]>()\r\n\r\n    const displayItemsFB = async() =>{\r\n        await getItems().then((response) => { setItemsFB(response)})\r\n    }\r\n    //ITEM VIEWED\r\n    const {getUsers} = usersApi\r\n\r\n    const addItemViewed = async(currentUser: Partial<User | undefined>, item:number) =>{\r\n        const itemsViewed = currentUser?.viewed || [];\r\n        itemsViewed.push(item)\r\n        await api_DB.patch(`/users/${currentUser?.idDB}.json`, { viewed: itemsViewed})\r\n        getUsers()\r\n\r\n    \r\n    }\r\n    const deleteItemViewed = async(currentUser: Partial<User | undefined>, item: number) =>{\r\n        const itemsViewed = currentUser?.viewed?.filter((i) => i !== item)\r\n        await api_DB.patch(`/users/${currentUser?.idDB}.json`, { viewed: itemsViewed})\r\n        getUsers()\r\n    }\r\n\r\n    const itemsViewed = (currentUser: Partial<User | undefined>, id: number) =>{\r\n        const itemViewed = currentUser?.viewed?.includes(id)\r\n        return itemViewed\r\n    }\r\n\r\n\r\nreturn {addItem, deleteItem, getItems, getDetail, setDetail, displayItemsFB, setPageParams, setSearchParams, addItemViewed, deleteItemViewed, itemsViewed, items, itemDetail, itemsFB, page }\r\n\r\n}\r\n\r\nexport {useItems}"]},"metadata":{},"sourceType":"module"}